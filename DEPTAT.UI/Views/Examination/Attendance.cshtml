@*@model IEnumerable<DEPTAT.Application.Responses.DebtorsResponse>*@
@{
	var programmeList = ViewBag.ProgrammeList as List<ProgrammeResponse>;
}
<div class="container-fluid">

	<!-- Horizontal Layout -->
	<div class="row clearfix">
		<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
			<div class="card">
				<div class="header">
					<h2>
						SELECT PROGRAMME
					</h2>
					<div align="center">
					</div>
					<ul class="header-dropdown m-r--5">
						@*<li class="dropdown">
						<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
						<i class="material-icons">more_vert</i>
						</a>
						<ul class="dropdown-menu pull-right">
						<li><a href="javascript:void(0);">Add Data</a></li>
						<li><a href="~/uploads/template/DebtTemplate.xlsx">Download Template</a></li>
						<li><a href="javascript:void(0);">Something else here</a></li>
						</ul>
						</li>*@
					</ul>
				</div>
				<div class="body">
					@*<form action="/target" class="dropzone" id="my-form"></form>*@
					<form class="form-horizontal" id="registerForm" method="GET">

						<div class="row clearfix">
							<div class="col-lg-2 col-md-2 col-sm-4 col-xs-4 form-control-label">
								<label for="file">Student Number:</label>
							</div>
							<div class="col-sm-6">
								<select class="form-control show-tick" id="programmeId" name="ProgrammeId">
									<option value="0">-- Please select --</option>
									@foreach (var programme in programmeList)
									{
										<option value="@programme.Id">@programme.Name</option>
									}
								</select>
							</div>



						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<!-- #END# Horizontal Layout -->
	<!-- Horizontal Layout -->
	<div class="row clearfix">
		<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
			<div class="card">
				<div class="header">
					<h2>
						STUDENTS
					</h2>

				</div>
				<div class="body">
					<div id="showData"></div>
						
					
					
				</div>
			</div>
		</div>
	</div>
	<!-- #END# Horizontal Layout -->

</div>


@*<script type="text/ecmascript">
	$(document).ready(function() {
		
		$('#programmeId').change(function(){
		  var programme = $("#programmeId").val();
		  
		  
		  var output =``;
		  

		  $.ajax({
				url: $('#base_url').text() + '/Examination/GetStudentByProgramme',
			contentType: "application/json",
			type: 'GET',

			//data: JSON.stringify(updateDebtor),
				data: {ProgrammeName: programme},
			success: function(response) {
					console.log(response.result);
				if (response.isSuccess) {
					if(response.result == null){
						
						output +=`

	
									<div class="table-responsive">
										<table class="table table-bordered table-striped table-hover dataTable js-exportable">
											<thead>
												<tr>


													<th>Student Number</th>
													<th>FullName</th>
													<th>Action</th>
												</tr>
											</thead>
											<tbody>
								`;
								$.each(response.result, function(index, element) {
								  // Code to be executed for each element
									  output +=`
											<tr>
												<td>${element.StudentNumber}</td>
														<td>${element.fullName}</td>
														<td>
																			<span>
																					<i class="material-icons text-success update" id="${element.StudentNumber}" style="cursor: pointer">edit</i>
																					<i class="material-icons text-primary detail" id="${element.StudentNumber}" style="cursor: pointer">remove_red_eye</i>

																			</span>
																		</td>
											</tr>
									  
									  `;
								});
																
								
						}

				
						
						
					
				} else {
					output +=`
						<div class="alert bg-green alert-dismissible" role="alert">
											<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
											Sorry no records found...
										</div>
					
					`;
				}
				$("#showData").html(output);
			}

		});
	});

		
});
		

</script>*@



<script type="text/ecmascript">
	$(document).ready(function () {

		$('#programmeId').change(function () {
			var programme = $("#programmeId").val();
			var output = "";

			$.ajax({
				url: $('#base_url').text() + '/Examination/GetStudentByProgramme',
				type: 'json',
				type: 'GET',
				data: { ProgrammeName: programme },
				success: function (response) {
					console.log(response.result);
					if (response.isSuccess) {
						if (response.result && response.result.length > 0) {
							output += `
								<div class="table-responsive">
									<table class="table table-bordered table-striped table-hover dataTable js-exportable">
										<thead>
											<tr>
												<th>Student Number</th>
												<th>FullName</th>
												<th>Action</th>
											</tr>
										</thead>
										<tbody>
							`;

							$.each(response.result, function (index, element) {
								output += `
									<tr>
											<td>${element.studentNumber}</td>
										<td>${element.fullName}</td>
										<td>
											<span>
												<i class="material-icons text-success update" id="${element.studentNumber}" style="cursor: pointer">edit</i>
												<i class="material-icons text-primary detail" id="${element.studentNumber}" style="cursor: pointer">remove_red_eye</i>
											</span>
										</td>
									</tr>
								`;
							});

							output += `
									</tbody>
								</table>
							</div>
							`;
						} else {
							output += `
								<div class="alert bg-green alert-dismissible" role="alert">
									<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									Sorry no records found...
								</div>
							`;
						}
					} else {
						output += `
							<div class="alert bg-red alert-dismissible" role="alert">
								<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								Error: ${response.message}
							</div>
						`;
					}

					$("#showData").html(output);
				},
				error: function (xhr, status, error) {
					output += `
						<div class="alert bg-red alert-dismissible" role="alert">
							<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							Error: ${error}
						</div>
					`;

					$("#showData").html(output);
				}
			});
		});

	});
</script>